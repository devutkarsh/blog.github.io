<!doctype html><html lang=en-us>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=theme-color content="dark">
<title>Getting started with Kubernetes Manifests | Dev Utkarsh</title>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-NMJNTL3ZZN"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-NMJNTL3ZZN',{anonymize_ip:!1})}</script>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','G-NMJNTL3ZZN','auto'),ga('send','pageview'))</script>
<script async src=https://www.google-analytics.com/analytics.js></script>
<meta property="og:site_name" content="Dev Utkarsh Blog">
<meta property="og:title" content="Getting started with Kubernetes Manifests | Dev Utkarsh">
<meta itemprop=name content="Getting started with Kubernetes Manifests | Dev Utkarsh">
<meta name=twitter:title content="Getting started with Kubernetes Manifests | Dev Utkarsh">
<meta name=application-name content="Getting started with Kubernetes Manifests | Dev Utkarsh">
<meta name=description content="How to write a basic deployment and service.">
<meta name=twitter:description content="How to write a basic deployment and service. ">
<meta itemprop=description content=" How to write a basic deployment and service. ">
<meta property="og:description" content=" How to write a basic deployment and service. ">
<meta property="og:type" content="article">
<meta property="article:publisher" content="Dev Utkarsh">
<meta property="og:article:published_time" content="2021-09-23T00:00:00Z">
<meta property="article:published_time" content="2021-09-23T00:00:00Z">
<script defer type=application/ld+json>{"@context":"http://schema.org","@type":"Article","headline":"Getting started with Kubernetes Manifests","author":{"@type":"Person","name":"Dev Utkarsh"},"datePublished":"2021-09-23","description":"How to write a basic deployment and service.","wordCount":1242,"mainEntityOfPage":"True","dateModified":"2021-09-23","publisher":{"@type":"Organization","name":"Dev Utkarsh","logo":{"@type":"imageObject","url":"https:\/\/blog.devutkarsh.com\/favicon.ico"}}}</script>
<link rel="shortcut icon" type=image/x-icon href=/favicon.ico>
<link rel=stylesheet href=/sass/main.min.dca40d853c3d06706aaa6f0ae6aeb36bb27369100ac7e478776cfff9b4ac4d4e.css>
<style>:root{--article-font-family:"Titillium Web", var(--base-font-family)}</style>
<script>(function(){const a=document.createElement('link');a.href="https://fonts.googleapis.com/css2?family=Titillium+Web:wght@400;700&display=swap",a.type="text/css",a.rel="stylesheet",document.head.appendChild(a)})()</script>
</head>
<script>(function(){const b='ThemeColorScheme',a=localStorage.getItem(b),c=window.matchMedia('(prefers-color-scheme: dark)').matches===!0;a=='dark'||a==='dark'&&c?document.documentElement.dataset.userColorScheme='dark':document.documentElement.dataset.userColorScheme='dark'})()</script>
<body class=dark>
<nav class=navbar>
<div class=container>
<div class=flex>
<div>
<a class=brand href=/>
Dev Utkarsh
</a>
</div>
<div class=flex>
<a href=/articles/>Articles</a>
<a href=https://devutkarsh.com>Music</a>
<button id=dark-mode-button><svg class="light" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="1em" height="1em" style="-ms-transform:rotate(360deg);-webkit-transform:rotate(360deg);transform:rotate(360deg)" viewBox="0 0 36 36"><path fill="#ffd983" d="M30.312.776C32 19 20 32 .776 30.312c8.199 7.717 21.091 7.588 29.107-.429C37.9 21.867 38.03 8.975 30.312.776z"/><path d="M30.705 15.915a1.163 1.163.0 101.643 1.641 1.163 1.163.0 00-1.643-1.641zm-16.022 14.38a1.74 1.74.0 000 2.465 1.742 1.742.0 100-2.465zm13.968-2.147a2.904 2.904.0 01-4.108.0 2.902 2.902.0 010-4.107 2.902 2.902.0 014.108.0 2.902 2.902.0 010 4.107z" fill="#ffcc4d"/><rect x="0" y="0" width="36" height="36" fill="rgba(0, 0, 0, 0)"/></svg><svg class="dark" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="1em" height="1em" style="-ms-transform:rotate(360deg);-webkit-transform:rotate(360deg);transform:rotate(360deg)" viewBox="0 0 36 36"><path fill="#ffd983" d="M16 2s0-2 2-2 2 2 2 2v2s0 2-2 2-2-2-2-2V2zm18 14s2 0 2 2-2 2-2 2h-2s-2 0-2-2 2-2 2-2h2zM4 16s2 0 2 2-2 2-2 2H2s-2 0-2-2 2-2 2-2h2zm5.121-8.707s1.414 1.414.0 2.828-2.828.0-2.828.0L4.878 8.708s-1.414-1.414.0-2.829c1.415-1.414 2.829.0 2.829.0l1.414 1.414zm21 21s1.414 1.414.0 2.828-2.828.0-2.828.0l-1.414-1.414s-1.414-1.414.0-2.828 2.828.0 2.828.0l1.414 1.414zm-.413-18.172s-1.414 1.414-2.828.0.0-2.828.0-2.828l1.414-1.414s1.414-1.414 2.828.0.0 2.828.0 2.828l-1.414 1.414zm-21 21s-1.414 1.414-2.828.0.0-2.828.0-2.828l1.414-1.414s1.414-1.414 2.828.0.0 2.828.0 2.828l-1.414 1.414zM16 32s0-2 2-2 2 2 2 2v2s0 2-2 2-2-2-2-2v-2z"/><circle fill="#ffd983" cx="18" cy="18" r="10"/><rect x="0" y="0" width="36" height="36" fill="rgba(0, 0, 0, 0)"/></svg>
</button>
</div>
</div>
</div>
</nav>
<main>
<div class=container>
<article>
<header class=article-header>
<div class=thumb>
<div>
<h1>Getting started with Kubernetes Manifests</h1>
<div class=post-meta>
<div>
By Dev Utkarsh | <time>September 23, 2021</time>
| 6 minutes
</div>
<div class=tags>
<a href=/tags/kubectl/>kubectl</a>
<a href=/tags/microservice/>microservice</a>
<a href=/tags/kubernetes/>kubernetes</a>
</div>
</div>
</div>
</div>
</header>
</article>
<div class=article-post>
<h2 id=deploy-your-first-container-on-kuberentes-cluster>
<a href=#deploy-your-first-container-on-kuberentes-cluster class=anchor><svg class="icon" aria-hidden="true" focusable="false" height="16" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5.0-3-1.69-3-3.5S2.55 3 4 3h4c1.45.0 3 1.69 3 3.5.0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98.0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98.0-2-1.22-2-2.5.0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45.0 3-1.69 3-3.5S14.5 6 13 6z"/></svg>
</a>
Deploy your first container on Kuberentes cluster
</h2>
<p>Well if you have followed us on the previous blog post on <a href=../how-to-create-a-kubernetes-cluster-on-aws-eks>how to create a kubernetes cluster on AWS EKS</a> or have gone with local kubernetes clusters like <a href=https://minikube.sigs.k8s.io/docs/start/><code>minikube</code></a> etc. Then you must be aware that to manage all the resources & objects on your cluster you will need a command line tool <a href=https://kubernetes.io/docs/tasks/tools/install-kubectl-macos/><code>kubectl</code></a> which interacts on your behalf with the <code>kube-api-server</code> to perform almost all operations on your cluster.</p>
<h3 id=what-are-deployments--pods>
<a href=#what-are-deployments--pods class=anchor><svg class="icon" aria-hidden="true" focusable="false" height="16" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5.0-3-1.69-3-3.5S2.55 3 4 3h4c1.45.0 3 1.69 3 3.5.0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98.0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98.0-2-1.22-2-2.5.0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45.0 3-1.69 3-3.5S14.5 6 13 6z"/></svg>
</a>
What are deployments &amp;amp; pods?
</h3>
<p>A deployment can be understood as a template that defines how your actual running container will look like based on the specifications provided. Each actual running container is build from the deployment specified and is termed as a pod.
A sample deployment will look like below -</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-deployment.yaml data-lang=deployment.yaml><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>apps/v1</span><span class=w>
</span><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Deployment</span><span class=w>
</span><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>s3-streamer</span><span class=w>
</span><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>default</span><span class=w>
</span><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=nt>replicas</span><span class=p>:</span><span class=w> </span><span class=m>1</span><span class=w>
</span><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=nt>matchLabels</span><span class=p>:</span><span class=w>
</span><span class=w>      </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>s3-streamer</span><span class=w> </span><span class=c># used by deployment</span><span class=w>
</span><span class=w>  </span><span class=nt>template</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span><span class=w>      </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span><span class=w>        </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>s3-streamer</span><span class=w> </span><span class=c># used for marking pods</span><span class=w>
</span><span class=w>    </span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span><span class=w>      </span><span class=nt>containers</span><span class=p>:</span><span class=w>
</span><span class=w>        </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>s3-streamer</span><span class=w>
</span><span class=w>          </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>devutkarsh/s3-streamer</span><span class=w> </span><span class=c>#image hosted on docker hub</span><span class=w>
</span><span class=w>          </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span><span class=w>            </span>- <span class=nt>containerPort</span><span class=p>:</span><span class=w> </span><span class=m>9999</span><span class=w> 
</span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>This is a deployment manifest for a microservice named s3-streamer written on Java to stream AWS S3 obkects into cluster. More details about the service can be <a href=../streaming-aws-s3-objects-in-aws-eks-cluster/>found here</a>.</p>
</blockquote>
<p>To apply this deployment you can do to saved directory and run following command in your OS terminal-</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-zsh data-lang=zsh>kubectl apply -k deployment.yaml
</code></pre></td></tr></table>
</div>
</div><p>And see a similar output -</p>
<pre tabindex=0><code>deployment.apps/s3-streamer created
</code></pre><p>Then you can run commands to get deployment and pods to see them running status -</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-zsh data-lang=zsh>devutkarsh@ud s3-streamer % kubectl get deployment
NAME          READY   UP-TO-DATE   AVAILABLE   AGE
s3-streamer   1/1     <span class=m>1</span>            <span class=m>1</span>           19m
devutkarsh@ud s3-streamer % kubectl get pods      
NAME                           READY   STATUS    RESTARTS   AGE
s3-streamer-78779d7c85-j7clz   1/1     Running   <span class=m>0</span>          19m
</code></pre></td></tr></table>
</div>
</div><p>You can further run <strong>describe</strong> commands on your resources to understand more on what&rsquo;s happening by running - <code>kubectl describe pod s3-streamer-78779d7c85-j7clz</code></p>
<blockquote>
<p>What&rsquo;s important to note here is that there can be multiple pods running for the same deployment based on the replica count set, comes handy in case of load distribution and canary deployments.
Also, another important point to note down here is that this application running on port 9999 is just like a black box and has no cluster endpoint assigned to it. So it will not be accessible over the network, but can only be accessed by port-forwarding the pod or deployment directly as of now. Each pod will have it&rsquo;s own random IP which we can&rsquo;t guess because pods are volatile.</p>
</blockquote>
<h3 id=what-is-a-service>
<a href=#what-is-a-service class=anchor><svg class="icon" aria-hidden="true" focusable="false" height="16" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5.0-3-1.69-3-3.5S2.55 3 4 3h4c1.45.0 3 1.69 3 3.5.0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98.0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98.0-2-1.22-2-2.5.0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45.0 3-1.69 3-3.5S14.5 6 13 6z"/></svg>
</a>
What is a Service?
</h3>
<p>As stated in the note above that the deployed pods will not be accessible over cluster network because they have no known IP assigned (but some random IP&rsquo;s based on your cluster CIDR block). This is exactly the problem that a service sovles for you. It assigns a specific cluster DNS endpoint to your deployment and then all the pods that are running for that particular deployment are load balanced under a single DNS name in a round robin fashion. This all networking is taken care by <code>kube-proxy</code> agent on your cluster.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-service.yaml data-lang=service.yaml><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Service</span><span class=w>
</span><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>s3-streamer</span><span class=w>
</span><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>s3-streamer</span><span class=w>
</span><span class=w>  </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>ClusterIP</span><span class=w>
</span><span class=w>  </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>http</span><span class=w>
</span><span class=w>      </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>9999</span><span class=w>
</span><span class=w>      </span><span class=nt>targetPort</span><span class=p>:</span><span class=w> </span><span class=m>9999</span><span class=w>
</span></code></pre></td></tr></table>
</div>
</div><p>To apply this service run the following command in your OS terminal -</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-zsh data-lang=zsh>kubectl apply -k service.yaml
</code></pre></td></tr></table>
</div>
</div><p>And see a similar output -</p>
<pre tabindex=0><code>service/s3-streamer created
</code></pre><p>Then you can run commands to get or describe your service to see the status -</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-zsh data-lang=zsh>devutkarsh@ud s3-streamer % kubectl get svc
NAME                      TYPE        CLUSTER-IP      EXTERNAL-IP   PORT<span class=o>(</span>S<span class=o>)</span>    AGE
s3-streamer               ClusterIP   10.105.14.47    &lt;none&gt;        9999/TCP   29s
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>Now this service is configured to with a cluserIP. Also, the application would be available at http://service-name:port-number/ i.e. http://s3-streamer:9999/. For getting an external IP, maybe I will writer some other time</p>
</blockquote>
<h3 id=the-bridge-in-between>
<a href=#the-bridge-in-between class=anchor><svg class="icon" aria-hidden="true" focusable="false" height="16" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5.0-3-1.69-3-3.5S2.55 3 4 3h4c1.45.0 3 1.69 3 3.5.0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98.0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98.0-2-1.22-2-2.5.0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45.0 3-1.69 3-3.5S14.5 6 13 6z"/></svg>
</a>
The bridge in between
</h3>
<p>The deployment is an independent resource and so it the service. So we need to make sure that both are intertwined, which is taken care by the <code>label</code> in deployment.yaml and <code>selector</code> in service.yaml. In this way the provided selector <code>app=s3-streamer</code> in service yaml knows that it needs to take care all the pods with same labels while load balancing.</p>
<p>To test this we will create a throw away pod with curl busy box docker image-</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-zsh data-lang=zsh>kubectl run curl-test --image<span class=o>=</span>radial/busyboxplus:curl -i --tty --rm
</code></pre></td></tr></table>
</div>
</div><p>The run curl command, keep the output handy and exit the pod. -</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-zsh data-lang=zsh><span class=o>[</span> root@curl-test:/ <span class=o>]</span>$ curl -I  http://s3-streamer:9999/abc/xyz
HTTP/1.1 <span class=m>400</span> 
Content-Length: <span class=m>0</span>
Date: Fri, <span class=m>24</span> Sep <span class=m>2021</span> 19:44:01 GMT
Connection: close

<span class=o>[</span> root@curl-test:/ <span class=o>]</span>$ <span class=nb>exit</span>
Session ended, resume using <span class=s1>&#39;kubectl attach curl-test -c curl-test -i -t&#39;</span> <span class=nb>command</span> when the pod is running
pod <span class=s2>&#34;curl-test&#34;</span> deleted
</code></pre></td></tr></table>
</div>
</div><p>This resulted in 400 status error because it was looking for a s3 bucket abc with objeck key xyz which is not present, but we know that we were able to trigger the service communication atleast.</p>
<p>To verify that s3-streamer service was invoked using the DNS assigned on the local cluster network from inside of our throw away pod, we will take a look at the logs generatd by s3-streamer service as pasted below. To confirm we can see line number 27 in the output -</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=n>devutkarsh</span><span class=nd>@ud</span> <span class=n>s3</span><span class=o>-</span><span class=n>streamer</span> <span class=o>%</span> <span class=n>kubectl</span> <span class=n>get</span> <span class=n>pods</span>
<span class=n>NAME</span>                          <span class=n>READY</span>   <span class=n>STATUS</span>    <span class=n>RESTARTS</span>   <span class=n>AGE</span>
<span class=n>s3</span><span class=o>-</span><span class=n>streamer</span><span class=o>-</span><span class=n>f8585b8cc</span><span class=o>-</span><span class=n>c8rvb</span>   <span class=n>1</span><span class=o>/</span><span class=n>1</span>     <span class=n>Running</span>   <span class=n>0</span>          <span class=n>12m</span>
<span class=n>devutkarsh</span><span class=nd>@ud</span> <span class=n>s3</span><span class=o>-</span><span class=n>streamer</span> <span class=o>%</span> <span class=n>kubectl</span> <span class=n>logs</span> <span class=n>s3</span><span class=o>-</span><span class=n>streamer</span><span class=o>-</span><span class=n>f8585b8cc</span><span class=o>-</span><span class=n>c8rvb</span>

  <span class=o>.</span>   <span class=n>____</span>          <span class=n>_</span>            <span class=n>__</span> <span class=n>_</span> <span class=n>_</span>
 <span class=o>/</span><span class=err>\\</span> <span class=o>/</span> <span class=n>___</span><span class=err>&#39;</span><span class=n>_</span> <span class=n>__</span> <span class=n>_</span> <span class=nf>_</span><span class=o>(</span><span class=n>_</span><span class=o>)</span><span class=n>_</span> <span class=n>__</span>  <span class=n>__</span> <span class=n>_</span> <span class=err>\</span> <span class=err>\</span> <span class=err>\</span> <span class=err>\</span>
<span class=o>(</span> <span class=o>(</span> <span class=o>)</span><span class=err>\</span><span class=n>___</span> <span class=o>|</span> <span class=err>&#39;</span><span class=n>_</span> <span class=o>|</span> <span class=err>&#39;</span><span class=n>_</span><span class=o>|</span> <span class=o>|</span> <span class=err>&#39;</span><span class=n>_</span> <span class=err>\</span><span class=o>/</span> <span class=n>_</span><span class=err>`</span> <span class=o>|</span> <span class=err>\</span> <span class=err>\</span> <span class=err>\</span> <span class=err>\</span>
 <span class=err>\\</span><span class=o>/</span>  <span class=n>___</span><span class=o>)|</span> <span class=o>|</span><span class=n>_</span><span class=o>)|</span> <span class=o>|</span> <span class=o>|</span> <span class=o>|</span> <span class=o>|</span> <span class=o>||</span> <span class=o>(</span><span class=n>_</span><span class=o>|</span> <span class=o>|</span>  <span class=o>)</span> <span class=o>)</span> <span class=o>)</span> <span class=o>)</span>
  <span class=err>&#39;</span>  <span class=o>|</span><span class=n>____</span><span class=o>|</span> <span class=o>.</span><span class=na>__</span><span class=o>|</span><span class=n>_</span><span class=o>|</span> <span class=o>|</span><span class=n>_</span><span class=o>|</span><span class=n>_</span><span class=o>|</span> <span class=o>|</span><span class=n>_</span><span class=err>\</span><span class=n>__</span><span class=o>,</span> <span class=o>|</span> <span class=o>/</span> <span class=o>/</span> <span class=o>/</span> <span class=o>/</span>
 <span class=o>=========|</span><span class=n>_</span><span class=o>|==============|</span><span class=n>___</span><span class=o>/=/</span><span class=n>_</span><span class=o>/</span><span class=n>_</span><span class=o>/</span><span class=n>_</span><span class=o>/</span>
 <span class=o>::</span> <span class=n>Spring</span> <span class=n>Boot</span> <span class=o>::</span>                <span class=o>(</span><span class=n>v2</span><span class=o>.</span><span class=na>4</span><span class=o>.</span><span class=na>3</span><span class=o>)</span>

<span class=n>2021</span><span class=o>-</span><span class=n>09</span><span class=o>-</span><span class=n>24</span> <span class=n>19</span><span class=o>:</span><span class=n>37</span><span class=o>:</span><span class=n>02</span><span class=o>.</span><span class=na>515</span>  <span class=n>INFO</span> <span class=n>1</span> <span class=o>---</span> <span class=o>[</span>           <span class=n>main</span><span class=o>]</span> <span class=n>com</span><span class=o>.</span><span class=na>s3streamer</span><span class=o>.</span><span class=na>Init</span>                      <span class=o>:</span> <span class=n>Starting</span> <span class=n>Init</span> <span class=n>using</span> <span class=n>Java</span> <span class=n>1</span><span class=o>.</span><span class=na>8</span><span class=o>.</span><span class=na>0_212</span> <span class=n>on</span> <span class=n>s3</span><span class=o>-</span><span class=n>streamer</span><span class=o>-</span><span class=n>f8585b8cc</span><span class=o>-</span><span class=n>c8rvb</span> <span class=n>with</span> <span class=n>PID</span> <span class=nf>1</span> <span class=o>(/</span><span class=n>s3</span><span class=o>-</span><span class=n>streamer</span><span class=o>-</span><span class=n>0</span><span class=o>.</span><span class=na>0</span><span class=o>.</span><span class=na>1</span><span class=o>-</span><span class=n>SNAPSHOT</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>s3</span><span class=o>-</span><span class=n>streamer</span><span class=o>-</span><span class=n>0</span><span class=o>.</span><span class=na>0</span><span class=o>.</span><span class=na>1</span><span class=o>-</span><span class=n>SNAPSHOT</span><span class=o>.</span><span class=na>jar</span> <span class=n>started</span> <span class=n>by</span> <span class=n>root</span> <span class=n>in</span> <span class=o>/)</span>
<span class=n>2021</span><span class=o>-</span><span class=n>09</span><span class=o>-</span><span class=n>24</span> <span class=n>19</span><span class=o>:</span><span class=n>37</span><span class=o>:</span><span class=n>02</span><span class=o>.</span><span class=na>521</span>  <span class=n>INFO</span> <span class=n>1</span> <span class=o>---</span> <span class=o>[</span>           <span class=n>main</span><span class=o>]</span> <span class=n>com</span><span class=o>.</span><span class=na>s3streamer</span><span class=o>.</span><span class=na>Init</span>                      <span class=o>:</span> <span class=n>No</span> <span class=n>active</span> <span class=n>profile</span> <span class=n>set</span><span class=o>,</span> <span class=n>falling</span> <span class=n>back</span> <span class=n>to</span> <span class=k>default</span> <span class=n>profiles</span><span class=o>:</span> <span class=k>default</span>
<span class=n>2021</span><span class=o>-</span><span class=n>09</span><span class=o>-</span><span class=n>24</span> <span class=n>19</span><span class=o>:</span><span class=n>37</span><span class=o>:</span><span class=n>05</span><span class=o>.</span><span class=na>322</span>  <span class=n>INFO</span> <span class=n>1</span> <span class=o>---</span> <span class=o>[</span>           <span class=n>main</span><span class=o>]</span> <span class=n>o</span><span class=o>.</span><span class=na>s</span><span class=o>.</span><span class=na>b</span><span class=o>.</span><span class=na>w</span><span class=o>.</span><span class=na>embedded</span><span class=o>.</span><span class=na>tomcat</span><span class=o>.</span><span class=na>TomcatWebServer</span>  <span class=o>:</span> <span class=n>Tomcat</span> <span class=n>initialized</span> <span class=n>with</span> <span class=nf>port</span><span class=o>(</span><span class=n>s</span><span class=o>):</span> <span class=n>9999</span> <span class=o>(</span><span class=n>http</span><span class=o>)</span>
<span class=n>2021</span><span class=o>-</span><span class=n>09</span><span class=o>-</span><span class=n>24</span> <span class=n>19</span><span class=o>:</span><span class=n>37</span><span class=o>:</span><span class=n>05</span><span class=o>.</span><span class=na>345</span>  <span class=n>INFO</span> <span class=n>1</span> <span class=o>---</span> <span class=o>[</span>           <span class=n>main</span><span class=o>]</span> <span class=n>o</span><span class=o>.</span><span class=na>apache</span><span class=o>.</span><span class=na>catalina</span><span class=o>.</span><span class=na>core</span><span class=o>.</span><span class=na>StandardService</span>   <span class=o>:</span> <span class=n>Starting</span> <span class=n>service</span> <span class=o>[</span><span class=n>Tomcat</span><span class=o>]</span>
<span class=n>2021</span><span class=o>-</span><span class=n>09</span><span class=o>-</span><span class=n>24</span> <span class=n>19</span><span class=o>:</span><span class=n>37</span><span class=o>:</span><span class=n>05</span><span class=o>.</span><span class=na>346</span>  <span class=n>INFO</span> <span class=n>1</span> <span class=o>---</span> <span class=o>[</span>           <span class=n>main</span><span class=o>]</span> <span class=n>org</span><span class=o>.</span><span class=na>apache</span><span class=o>.</span><span class=na>catalina</span><span class=o>.</span><span class=na>core</span><span class=o>.</span><span class=na>StandardEngine</span>  <span class=o>:</span> <span class=n>Starting</span> <span class=n>Servlet</span> <span class=n>engine</span><span class=o>:</span> <span class=o>[</span><span class=n>Apache</span> <span class=n>Tomcat</span><span class=o>/</span><span class=n>9</span><span class=o>.</span><span class=na>0</span><span class=o>.</span><span class=na>43</span><span class=o>]</span>
<span class=n>2021</span><span class=o>-</span><span class=n>09</span><span class=o>-</span><span class=n>24</span> <span class=n>19</span><span class=o>:</span><span class=n>37</span><span class=o>:</span><span class=n>05</span><span class=o>.</span><span class=na>505</span>  <span class=n>INFO</span> <span class=n>1</span> <span class=o>---</span> <span class=o>[</span>           <span class=n>main</span><span class=o>]</span> <span class=n>o</span><span class=o>.</span><span class=na>a</span><span class=o>.</span><span class=na>c</span><span class=o>.</span><span class=na>c</span><span class=o>.</span><span class=na>C</span><span class=o>.[</span><span class=n>Tomcat</span><span class=o>].[</span><span class=n>localhost</span><span class=o>].[/]</span>       <span class=o>:</span> <span class=n>Initializing</span> <span class=n>Spring</span> <span class=n>embedded</span> <span class=n>WebApplicationContext</span>
<span class=n>2021</span><span class=o>-</span><span class=n>09</span><span class=o>-</span><span class=n>24</span> <span class=n>19</span><span class=o>:</span><span class=n>37</span><span class=o>:</span><span class=n>05</span><span class=o>.</span><span class=na>506</span>  <span class=n>INFO</span> <span class=n>1</span> <span class=o>---</span> <span class=o>[</span>           <span class=n>main</span><span class=o>]</span> <span class=n>w</span><span class=o>.</span><span class=na>s</span><span class=o>.</span><span class=na>c</span><span class=o>.</span><span class=na>ServletWebServerApplicationContext</span> <span class=o>:</span> <span class=n>Root</span> <span class=n>WebApplicationContext</span><span class=o>:</span> <span class=n>initialization</span> <span class=n>completed</span> <span class=n>in</span> <span class=n>2837</span> <span class=n>ms</span>
<span class=n>2021</span><span class=o>-</span><span class=n>09</span><span class=o>-</span><span class=n>24</span> <span class=n>19</span><span class=o>:</span><span class=n>37</span><span class=o>:</span><span class=n>06</span><span class=o>.</span><span class=na>432</span>  <span class=n>INFO</span> <span class=n>1</span> <span class=o>---</span> <span class=o>[</span>           <span class=n>main</span><span class=o>]</span> <span class=n>o</span><span class=o>.</span><span class=na>s</span><span class=o>.</span><span class=na>s</span><span class=o>.</span><span class=na>concurrent</span><span class=o>.</span><span class=na>ThreadPoolTaskExecutor</span>  <span class=o>:</span> <span class=n>Initializing</span> <span class=n>ExecutorService</span> <span class=err>&#39;</span><span class=n>applicationTaskExecutor</span><span class=err>&#39;</span>
<span class=n>2021</span><span class=o>-</span><span class=n>09</span><span class=o>-</span><span class=n>24</span> <span class=n>19</span><span class=o>:</span><span class=n>37</span><span class=o>:</span><span class=n>06</span><span class=o>.</span><span class=na>879</span>  <span class=n>INFO</span> <span class=n>1</span> <span class=o>---</span> <span class=o>[</span>           <span class=n>main</span><span class=o>]</span> <span class=n>o</span><span class=o>.</span><span class=na>s</span><span class=o>.</span><span class=na>b</span><span class=o>.</span><span class=na>w</span><span class=o>.</span><span class=na>embedded</span><span class=o>.</span><span class=na>tomcat</span><span class=o>.</span><span class=na>TomcatWebServer</span>  <span class=o>:</span> <span class=n>Tomcat</span> <span class=n>started</span> <span class=n>on</span> <span class=nf>port</span><span class=o>(</span><span class=n>s</span><span class=o>):</span> <span class=n>9999</span> <span class=o>(</span><span class=n>http</span><span class=o>)</span> <span class=n>with</span> <span class=n>context</span> <span class=n>path</span> <span class=err>&#39;&#39;</span>
<span class=n>2021</span><span class=o>-</span><span class=n>09</span><span class=o>-</span><span class=n>24</span> <span class=n>19</span><span class=o>:</span><span class=n>37</span><span class=o>:</span><span class=n>06</span><span class=o>.</span><span class=na>917</span>  <span class=n>INFO</span> <span class=n>1</span> <span class=o>---</span> <span class=o>[</span>           <span class=n>main</span><span class=o>]</span> <span class=n>com</span><span class=o>.</span><span class=na>s3streamer</span><span class=o>.</span><span class=na>Init</span>                      <span class=o>:</span> <span class=n>Started</span> <span class=n>Init</span> <span class=n>in</span> <span class=n>5</span><span class=o>.</span><span class=na>631</span> <span class=nf>seconds</span> <span class=o>(</span><span class=n>JVM</span> <span class=n>running</span> <span class=k>for</span> <span class=n>6</span><span class=o>.</span><span class=na>555</span><span class=o>)</span>
<span class=n>2021</span><span class=o>-</span><span class=n>09</span><span class=o>-</span><span class=n>24</span> <span class=n>19</span><span class=o>:</span><span class=n>40</span><span class=o>:</span><span class=n>24</span><span class=o>.</span><span class=na>830</span>  <span class=n>INFO</span> <span class=n>1</span> <span class=o>---</span> <span class=o>[</span><span class=n>nio</span><span class=o>-</span><span class=n>9999</span><span class=o>-</span><span class=n>exec</span><span class=o>-</span><span class=n>1</span><span class=o>]</span> <span class=n>o</span><span class=o>.</span><span class=na>a</span><span class=o>.</span><span class=na>c</span><span class=o>.</span><span class=na>c</span><span class=o>.</span><span class=na>C</span><span class=o>.[</span><span class=n>Tomcat</span><span class=o>].[</span><span class=n>localhost</span><span class=o>].[/]</span>       <span class=o>:</span> <span class=n>Initializing</span> <span class=n>Spring</span> <span class=n>DispatcherServlet</span> <span class=err>&#39;</span><span class=n>dispatcherServlet</span><span class=err>&#39;</span>
<span class=n>2021</span><span class=o>-</span><span class=n>09</span><span class=o>-</span><span class=n>24</span> <span class=n>19</span><span class=o>:</span><span class=n>40</span><span class=o>:</span><span class=n>24</span><span class=o>.</span><span class=na>830</span>  <span class=n>INFO</span> <span class=n>1</span> <span class=o>---</span> <span class=o>[</span><span class=n>nio</span><span class=o>-</span><span class=n>9999</span><span class=o>-</span><span class=n>exec</span><span class=o>-</span><span class=n>1</span><span class=o>]</span> <span class=n>o</span><span class=o>.</span><span class=na>s</span><span class=o>.</span><span class=na>web</span><span class=o>.</span><span class=na>servlet</span><span class=o>.</span><span class=na>DispatcherServlet</span>        <span class=o>:</span> <span class=n>Initializing</span> <span class=n>Servlet</span> <span class=err>&#39;</span><span class=n>dispatcherServlet</span><span class=err>&#39;</span>
<span class=n>2021</span><span class=o>-</span><span class=n>09</span><span class=o>-</span><span class=n>24</span> <span class=n>19</span><span class=o>:</span><span class=n>40</span><span class=o>:</span><span class=n>24</span><span class=o>.</span><span class=na>842</span>  <span class=n>INFO</span> <span class=n>1</span> <span class=o>---</span> <span class=o>[</span><span class=n>nio</span><span class=o>-</span><span class=n>9999</span><span class=o>-</span><span class=n>exec</span><span class=o>-</span><span class=n>1</span><span class=o>]</span> <span class=n>o</span><span class=o>.</span><span class=na>s</span><span class=o>.</span><span class=na>web</span><span class=o>.</span><span class=na>servlet</span><span class=o>.</span><span class=na>DispatcherServlet</span>        <span class=o>:</span> <span class=n>Completed</span> <span class=n>initialization</span> <span class=n>in</span> <span class=n>10</span> <span class=n>ms</span>
<span class=n>Fetching</span> <span class=o>/</span><span class=n>abc</span><span class=o>/</span><span class=n>xyz</span>
<span class=n>Error</span> <span class=n>The</span> <span class=n>bucket</span> <span class=n>is</span> <span class=n>in</span> <span class=k>this</span> <span class=n>region</span><span class=o>:</span> <span class=n>us</span><span class=o>-</span><span class=n>east</span><span class=o>-</span><span class=n>1</span><span class=o>.</span> <span class=n>Please</span> <span class=n>use</span> <span class=k>this</span> <span class=n>region</span> <span class=n>to</span> <span class=n>retry</span> <span class=n>the</span> <span class=nf>request</span> <span class=o>(</span><span class=n>Service</span><span class=o>:</span> <span class=n>Amazon</span> <span class=n>S3</span><span class=o>;</span> <span class=n>Status</span> <span class=n>Code</span><span class=o>:</span> <span class=n>301</span><span class=o>;</span> <span class=n>Error</span> <span class=n>Code</span><span class=o>:</span> <span class=n>PermanentRedirect</span><span class=o>;</span> <span class=n>Request</span> <span class=n>ID</span><span class=o>:</span> <span class=o>....</span>
</code></pre></td></tr></table>
</div>
</div><p>You can refer to the yaml&rsquo;s on my github repo as well &ndash;> <a href=https://github.com/devutkarsh/kubernetes/tree/master/apps/service-bases/s3-streamer>Kubernetes deployment and service example yaml</a>.</p>
<p>I will be next writing on how to setup these manifest for better configuration management to support deployment on different environments and support <a href=../how-to-configure-kubernetes-manifests-for-multiple-environments>Multiple environments (DEV, Staging, QA, Prod) with Kubernetes and Kustomize</a></p>
</div>
</div>
<div class=container>
<nav class="flex container suggested">
<a rel=prev href=/kisi-subah/ title="Previous post (older)">
<span>Previous</span>
Kisi Subah
</a>
</nav>
</div>
<div class=container>
</div>
</main>
</main>
<footer class="footer flex">
<section class=container>
<nav class=footer-links>
<a href=/>Â© 2021</a>
</nav>
</section>
<script defer src=/ts/features.5b0e1ea6de1458adc3d83cf2550066d995b148f384d34a9c1ddad2dd7d0fe110.js data-enable-footnotes=true></script>
</footer>
</body>
</html>